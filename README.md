# Lava
A compiler of C subset by USTB OWL Wheel Lab.  

Lava can compile extended SysY languate to ARM assembly and LLVM IR.

## Building
Lava requires:
- `cmake` 3.16 or later.
- C++ compiler supporting C++17 standard.


```shell script
git clone https://github.com/ustb-owl/Lava
cd compiler && mkdir build && cd build
cmake .. && make -j8
./lacc -h
```

## Usage

```
Usage: lacc [options...] [filename]
Options:
    -o, --output           set output file name
    -S, --dump-asm         generate asm file
    -I, --dump-ir          generate ir file
    -T, --dump-ast         generate ast file
    filename               input filename          (Required)
    -h, --help             Shows this page
```

## Features

- Handwritten frontend.
- Strong typed IR in SSA form.
- Can emit LLVM IR
- Optimizer based on pass and pass manager.
- Flexible phase order
- Low-level IR (LLIR) for multi-architecture machine instruction abstraction.

LLVM IR generated by Lava
```llvm
define i32 @ifElse() {
entry:
  %t0 = icmp eq i32 5, 5
  br i1 %t0, label %if.then0, label %if.else0

if.then0: ; preds: entry
  br label %if.end0

if.else0: ; preds: entry
  br label %if.end0

if.end0: ; preds: if.then0, if.else0
  %phi0 = phi i32 [ 25, %if.then0 ], [ 10, %if.else0 ]
  ret i32 %phi0
}

define i32 @main() {
entry:
  %t0 = call i32 @ifElse()
  ret i32 %t0
}
```

## Automated Testing Tools

See [lava-test](https://github.com/ustb-owl/lava-test)

